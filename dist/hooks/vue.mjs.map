{"version":3,"sources":["../../src/hooks/vue.ts"],"sourcesContent":["import { ref, onMounted, onUnmounted } from \"vue\";\r\nimport { createStream } from \"../index\";\r\nimport type { StreamAPI } from \"../core/types\";\r\n\r\nexport function useStream<T = unknown>(\r\n  opts: Parameters<typeof createStream>[0]\r\n) {\r\n  const api: StreamAPI = createStream(opts);\r\n  const messages = ref<T[]>([]);\r\n  const status = ref(api.state.status);\r\n  const error = ref<Error | null>(null);\r\n  const isOpen = ref(api.state.isOpen);\r\n\r\n  const offOpen = api.on(\"open\", () => {\r\n    isOpen.value = true;\r\n  });\r\n  const offClose = api.on(\"close\", () => {\r\n    isOpen.value = false;\r\n  });\r\n  const offStatus = api.on(\"status\", (s) => {\r\n    status.value = s;\r\n  });\r\n  const offError = api.on(\"error\", (e) => {\r\n    error.value = e;\r\n  });\r\n  const offMsg = api.on(\"message\", (m) => {\r\n    // Fix: Create new array to avoid Vue reactive typing issues\r\n    messages.value = [...messages.value, m] as T[];\r\n  });\r\n\r\n  onMounted(() => {\r\n    api.open();\r\n  });\r\n  onUnmounted(() => {\r\n    offOpen();\r\n    offClose();\r\n    offStatus();\r\n    offError();\r\n    offMsg();\r\n    api.close();\r\n  });\r\n\r\n  return { ...api, messages, status, error, isOpen };\r\n}\r\n"],"mappings":";;;;;AAAA,SAAS,KAAK,WAAW,mBAAmB;AAIrC,SAAS,UACd,MACA;AACA,QAAM,MAAiB,aAAa,IAAI;AACxC,QAAM,WAAW,IAAS,CAAC,CAAC;AAC5B,QAAM,SAAS,IAAI,IAAI,MAAM,MAAM;AACnC,QAAM,QAAQ,IAAkB,IAAI;AACpC,QAAM,SAAS,IAAI,IAAI,MAAM,MAAM;AAEnC,QAAM,UAAU,IAAI,GAAG,QAAQ,MAAM;AACnC,WAAO,QAAQ;AAAA,EACjB,CAAC;AACD,QAAM,WAAW,IAAI,GAAG,SAAS,MAAM;AACrC,WAAO,QAAQ;AAAA,EACjB,CAAC;AACD,QAAM,YAAY,IAAI,GAAG,UAAU,CAAC,MAAM;AACxC,WAAO,QAAQ;AAAA,EACjB,CAAC;AACD,QAAM,WAAW,IAAI,GAAG,SAAS,CAAC,MAAM;AACtC,UAAM,QAAQ;AAAA,EAChB,CAAC;AACD,QAAM,SAAS,IAAI,GAAG,WAAW,CAAC,MAAM;AAEtC,aAAS,QAAQ,CAAC,GAAG,SAAS,OAAO,CAAC;AAAA,EACxC,CAAC;AAED,YAAU,MAAM;AACd,QAAI,KAAK;AAAA,EACX,CAAC;AACD,cAAY,MAAM;AAChB,YAAQ;AACR,aAAS;AACT,cAAU;AACV,aAAS;AACT,WAAO;AACP,QAAI,MAAM;AAAA,EACZ,CAAC;AAED,SAAO,EAAE,GAAG,KAAK,UAAU,QAAQ,OAAO,OAAO;AACnD;","names":[]}